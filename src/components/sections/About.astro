---
import { Image } from 'astro:assets';
import logo from '../../assets/optimized/logo-hero.webp';
import { COMPANY_INFO } from '../../lib/constants-loader';
---

<section class="about section-bg-white" id="about" aria-labelledby="about-title">
  <div class="container">
    <div class="about__content">
      <!-- Contenido superior en 2 columnas: Logo + Descripción -->
      <div class="about__top-section grid-2-columns">
        <div class="about__image-wrapper image-container image-zoom--subtle">
          <figure class="about__img">
            <Image
              src={logo}
              alt="Logotipo de IG Construcciones - Empresa de arquitectura y construcción"
              loading="lazy"
              decoding="async"
              width={312}
              height={250}
              format="webp"
              quality={85}
              sizes="(max-width: 768px) 80vw, 312px"
              style="aspect-ratio: 312/250;"
            />
            <figcaption class="visually-hidden">
              Logo representativo de IG Construcciones, empresa especializada en arquitectura y construcción
            </figcaption>
          </figure>
          <div class="about__image-overlay image-overlay--light" aria-hidden="true"></div>
        </div>

        <hgroup class="about__text">
          <div class="section-header section-header--narrow text-left">
            <span class="section-subtitle" aria-hidden="true">Sobre Nosotros</span>
            <h2 class="section-title section-title--medium" id="about-title">Encabezado por un equipo sólido de profesionales</h2>
          </div>

          <div class="about__description">
            <p class="about__paragraph">
              Dedicados al área del diseño y la construcción. Con casi dos décadas de trayectoria,
              hemos aprendido a escuchar e interpretar cada detalle de los deseos de nuestros
              clientes.
            </p>

            <p class="about__paragraph">
              No solo construimos viviendas, creamos hogares funcionales y eficientes, adaptados
              perfectamente al entorno y a tu estilo de vida. Nuestro compromiso es total: desde el
              primer boceto hasta la entrega final, garantizamos seguridad, cumplimiento de plazos y
              un estándar de calidad insuperable.
            </p>
          </div>
        </hgroup>
      </div>

      <!-- Estadísticas en una fila horizontal abajo -->
      <div class="about__stats-section">
        <dl class="stats-container stats-container--horizontal" aria-label="Estadísticas de la empresa">
          <div class="stat-item">
            <dt class="stat-number" data-counter data-target={COMPANY_INFO.experience.replace('+','')} aria-label={`Más de ${COMPANY_INFO.experience}`}>
              0
              <span aria-hidden="true">+</span>
            </dt>
            <dd class="stat-label">Años de experiencia</dd>
          </div>
          <div class="stat-item">
            <dt class="stat-number" data-counter data-target={COMPANY_INFO.projects.replace('+','')} aria-label={`Más de ${COMPANY_INFO.projects}`}>
              0
              <span aria-hidden="true">+</span>
            </dt>
            <dd class="stat-label">Proyectos completados</dd>
          </div>
          <div class="stat-item">
            <dt class="stat-number" data-counter data-target={COMPANY_INFO.satisfaction.replace('%','')} aria-label={`${COMPANY_INFO.satisfaction} de satisfacción`}>
              0
              <span aria-hidden="true">%</span>
            </dt>
            <dd class="stat-label">Satisfacción del cliente</dd>
          </div>
        </dl>
      </div>
    </div>
  </div>
</section>

<script>
  // Hydration Strategy: lazy via central observer cuando el bloque de stats entra en viewport
  import('../../lib/interactions/observer').then(o => {
    const stats = document.querySelector('.about__stats-section');
    if (stats) o.onceVisible(stats, () => import('../../lib/interactions/counters').then(m => m.initCounters()));
  });
</script>

<style>
  /* Estilos específicos únicos del About */
  .about {
    padding: var(--spacing-2xl) 0;
  }

  .about__content {
    max-width: 1000px;
    margin: 0 auto;
    position: relative;
    z-index: 2;
    display: flex;
    flex-direction: column;
    gap: var(--spacing-2xl);
  }

  /* Sección superior: Logo + Descripción */
  .about__top-section {
    align-items: center;
  }

  .about__img {
    margin: 0;
    position: relative;
    z-index: 2;
  }

  .about__img img {
    width: 100%;
    height: 350px;
    object-fit: contain;
    border-radius: var(--border-radius-xl);
  }

  .about__text {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-md);
  }

  .about__description {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-md);
  }

  .about__paragraph {
    font-size: 1.125rem;
    line-height: 1.7;
    color: var(--color-neutral-700);
    margin: 0;
    text-align: justify;
  }

  /* Sección de estadísticas horizontal */
  .about__stats-section {
    width: 100%;
  }

  .stats-container--horizontal {
    display: flex;
    justify-content: space-around;
    align-items: center;
    gap: var(--spacing-xl);
    background: white;
    border-radius: var(--border-radius-xl);
    padding: var(--spacing-xl);
    box-shadow: var(--shadow-lg);
    margin: 0;
  }

  /* Estilos para la animación de estadísticas */
  .stat-item {
    opacity: 0;
    transform: translateY(20px);
    transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .stat-item.animate {
    opacity: 1;
    transform: translateY(0);
  }

  .stat-item:nth-child(1) {
    transition-delay: 0.1s;
  }

  .stat-item:nth-child(2) {
    transition-delay: 0.3s;
  }

  .stat-item:nth-child(3) {
    transition-delay: 0.5s;
  }

  .stat-number {
    font-size: 2.5rem;
    font-weight: 700;
    color: var(--color-primary);
    line-height: 1;
    margin-bottom: var(--spacing-xs);
    transition: transform 0.3s ease;
  }

  .stat-label {
    font-size: 0.875rem;
    color: var(--color-neutral-600);
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    text-align: center;
  }

  /* Responsive específico */
  @media (max-width: 1024px) {
    .about__content {
      gap: var(--spacing-xl);
    }

    .stats-container--horizontal {
      gap: var(--spacing-lg);
      padding: var(--spacing-lg);
    }
  }

  @media (max-width: 768px) {
    .about__content {
      text-align: center;
      gap: var(--spacing-lg);
    }

    .about__top-section {
      display: flex;
      flex-direction: column;
      gap: var(--spacing-lg);
    }

    .about__img img {
      height: 280px;
    }

    .stats-container--horizontal {
      flex-direction: column;
      gap: var(--spacing-md);
      text-align: center;
    }
  }

  @media (max-width: 480px) {
    .stats-container--horizontal {
      padding: var(--spacing-md);
    }
  }
</style>
